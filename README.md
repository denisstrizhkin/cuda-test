# Программирование вычислений на CUDA устройстве

## Информация о системе

Процессор: 12th Gen Intel(R) Core(TM) i7-12700K (20) @ 5.00 GHz

Видеокарта: NVIDIA A10

| Feature                            | Value        |
| :--------------------------------- | :----------- |
| **Compute Capability** | 8.6          |
| **Global Memory** | 22598 MB     |
| **Memory Clock Rate (Effective)** | 6251 MHz     |
| **GPU Clock Rate (Max)** | 1695 MHz     |
| **Shared Memory per Block** | 48 KB        |
| **Shared Memory per Multiprocessor** | 100 Bytes    |
| **Registers per Block** | 65536        |
| **Max Threads per Block** | 1024         |
| **Max Threads per Multiprocessor** | 1536         |
| **Multiprocessor Count** | 72           |
| **L2 Cache Size** | 6144 KB      |

## Матричное умножение

| Метод Умножения                        | Размер Матриц (N x M) x (M x K) | Время (мс) |
| :------------------------------------- | :------------------------------ | :--------- |
| **CPU** | (8x16) x (16x32)                | **0.037028** |
| CPU                                    | (64x128) x (128x256)            | 15.9813    |
| **Naive Multiplication (GPU)** | (8x16) x (16x32)                | 0.30208    |
| Naive Multiplication (GPU)             | (64x128) x (128x256)            | 0.395264   |
| Naive Multiplication (GPU)             | (1024x2048) x (2048x4096)       | 179.335    |
| **Shared Multiplication (GPU)** | (8x16) x (16x32)                | 0.143488   |
| Shared Multiplication (GPU)            | (64x128) x (128x256)            | **0.377856** |
| Shared Multiplication (GPU)            | (1024x2048) x (2048x4096)       | **126.967** |

### Анализ

* **CPU:** Быстрее для **очень малых матриц**, но значительно медленнее для больших объёмов данных из-за отсутствия параллелизма.
* **GPU (Naive):** Медленнее CPU на малых задачах из-за накладных расходов, но уже для средних матриц **значительно превосходит CPU**.
* **GPU (Shared Memory):** Использование **разделяемой памяти** существенно ускоряет вычисления на GPU, особенно заметно для больших матриц, где достигается **лучшая производительность**.

### Вывод

GPU, особенно с оптимизациями вроде **Shared Memory**, 
демонстрирует превосходство над CPU в умножении матриц для большинства реальных сценариев.
Для максимальной производительности на GPU критично эффективное использование иерархии памяти и,
при необходимости, низкоуровневых оптимизаций. Стоит отметить, что современные видео карты,
используют внутренние оптимизации, возможно из-за этого **Shared Memory** варианта достаточно
для достижения хорошей производительности.
